# Chapter5 GNN深入理解

- **斯坦福大学公开课CS224W的学习笔记**
- **Learner** : shenhao
- **Lecture 8**

## 5.1 图增强

### 5.1.1 为什么要进行图增强？

在之前的学习过程中，我们假设原始输入图的数据即为GNN的计算图，但很多情况下原始输入的图不一定就是最优的GNN计算图，主要存在以下几个层面的问题：

1. 特征层面：输入图可能**缺少特征**（也可能是**特征很难编码**） → 导致模型无法有效获取到图数据的信息
2. 结构层面：
   - 图可能**过度稀疏** → 导致message passing并不有效
   - 图可能**过度稠密** → 导致message passing代价太高（eg：从节点度很大的节点聚合所有邻居节点的信息代价太高）
   - 图可能**规模太大** → 导致无法在GPU上进行计算

针对以上几个问题，我们可以对输入的原始图数据进行**图增强**，比如：

1. 特征层面：输入图**缺少特征** → **增加特征**，进行**图特征增强**。
   - 比如：给图中的节点增加唯一ID标识，即用one-hot向量来表示特征或给每个节点赋常数特征值等

2. 结构层面：

   - 图**过度稀疏** → 增加虚拟的节点或者边

   - 图**过度稠密** → 在消息传递的过程中进行邻居采样

   - 图**规模太大** → 分割成若干个子图分别进行嵌入

### 5.1.2  图特征增强（Feature Augmentation）

#### 5.1.2.1 缺少特征下的图特征增强

输入图缺少节点特征是很常见的现象，比如只有邻接矩阵作为GNN的输入。在本章将主要介绍两种图特征增强的标准方法。

1. **给每个节点赋常数特征**	

   <img src="https://gitee.com/shenhao-stu/picgo/raw/master/Fastgit/image-20220507151223981.png"  />

2. **给图中的节点增加唯一ID标识**（即用one-hot向量来表示特征）

   ![](https://gitee.com/shenhao-stu/picgo/raw/master/Fastgit/image-20220507151332611.png)

3. 两种方法的比较：
   |          |                    constant node feature                     |                     one-hot node feature                     |
   | :------: | :----------------------------------------------------------: | :----------------------------------------------------------: |
   |   图示   | <img src="https://gitee.com/shenhao-stu/picgo/raw/master/Fastgit/image-20220507151223981.png" style="zoom:50%;" /> | <img src="https://gitee.com/shenhao-stu/picgo/raw/master/Fastgit/image-20220507151856089.png" style="zoom:50%;" /> |
   | 表达能力 | **中等**：所有节点都一样，但是**GNN仍然可以学到图结构信息**  |      **高**：每个节点ID唯一，所以可以储存节点特有的信息      |
   | 推理能力 |         **高**：对新节点可以赋于常数，再传入GNN即可          | **低**：无法泛化到新节点上，因为需要新增ID，无法用原先的one-hot向量来表示 |
   |  复杂度  |                     **低**：只有一维特征                     |         **高**：$O(\|V\|)$维特征，无法应用到大型图上         |
   | 适用情况 |                  所有图，inductive(归纳式)                   |                  小图，transductive(直推式)                  |

> **Inductive(归纳式) VS Transductive(直推式)**
>
> 机器学习训练通常涉及训练集（有标注）与测试集（无标注），具体分为两种模式：
>
> - 如果训练过程不需要测试集则是inductive
> - 如果训练过程需要测试集（无标注）则是transductive
>
> 注：测试集（无标注）不代表测试集真的没有label，仅表示在训练阶段可能会用到测试集但不包括label信息。
>
> 具体可以参考：👍[图解inductive+transductive ML](https://zhuanlan.zhihu.com/p/455808338)

#### 5.1.2.2 特征很难编码下的图特征增强